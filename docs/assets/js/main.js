"use strict";const listCharacteres=document.querySelector(".js-section-list"),btnSearch=document.querySelector(".js-btn"),input=document.querySelector(".js-input"),listFav=document.querySelector(".js-fav-list"),resetGlobal=document.querySelector(".js-reset");let characteres=[],favouriteCharacteres=[];fetch("https://breakingbadapi.com/api/characters").then(e=>e.json()).then(e=>{characteres=e,paintcharacteres(characteres)});let savedFavourites=JSON.parse(localStorage.getItem("favoroutecharacteres"));function paintcharacteres(e){listCharacteres.innerHTML="";for(const t of e){const e=document.createElement("li"),a=document.createElement("article");e.setAttribute("class","article js-li"),e.setAttribute("id",t.char_id);const r=document.createElement("img");r.setAttribute("src",t.img),r.setAttribute("class","img"),r.setAttribute("alt","characteres Breakin Bad"),a.appendChild(r);const c=document.createElement("h2"),n=document.createTextNode(t.name);c.appendChild(n),a.appendChild(c);const s=document.createElement("p"),i=document.createTextNode(t.status);s.appendChild(i),a.appendChild(s),e.appendChild(a),listCharacteres.appendChild(e),e.addEventListener("click",handleClickFav);-1!==favouriteCharacteres.findIndex(e=>e.char_id===t.char_id)?e.classList.add("selected"):e.classList.remove("selected")}}function paintcharacteresfav(e){listFav.innerHTML="";for(const t of e){const e=document.createElement("li"),a=document.createElement("article");e.setAttribute("class","article"),e.setAttribute("class","selected");const r=document.createElement("img");r.setAttribute("src",t.img),r.setAttribute("class","img"),r.setAttribute("alt","characteres Breakin Bad"),a.appendChild(r);const c=document.createElement("h2"),n=document.createTextNode(t.name);c.appendChild(n),a.appendChild(c);const s=document.createElement("p"),i=document.createTextNode(t.status);s.appendChild(i);const l=document.createElement("p"),d=document.createTextNode("X");l.appendChild(d),l.setAttribute("class","reset"),l.setAttribute("id",t.char_id),a.appendChild(s),a.appendChild(l),e.appendChild(a),listFav.appendChild(e),l.addEventListener("click",handleClickX)}}function localStorageSet(){localStorage.setItem("favoroutecharacteres",JSON.stringify(favouriteCharacteres))}function handleClickFav(e){e.currentTarget.classList.toggle("selected");const t=characteres.find(t=>t.char_id===parseInt(e.currentTarget.id)),a=favouriteCharacteres.findIndex(t=>t.char_id===parseInt(e.currentTarget.id));-1===a?(favouriteCharacteres.push(t),localStorageSet()):(favouriteCharacteres.splice(a,1),localStorageSet()),paintcharacteresfav(favouriteCharacteres)}function handleSearch(e){e.preventDefault(),resultApi()}function resultApi(){let e=[];listCharacteres.innerHTML="",fetch("https://breakingbadapi.com/api/characters?name="+input.value).then(e=>e.json()).then(t=>{e=t,paintcharacteres(e)})}function handleClickX(e){const t=favouriteCharacteres.findIndex(t=>t.char_id===parseInt(e.currentTarget.id));favouriteCharacteres.splice(t,1),localStorageSet(),paintcharacteresfav(favouriteCharacteres),resultApi()}function handleClickReset(){listFav.innerHTML="",favouriteCharacteres=[],paintcharacteresfav(favouriteCharacteres),paintcharacteres(characteres),localStorageSet()}null!==savedFavourites&&(favouriteCharacteres=savedFavourites,paintcharacteresfav(favouriteCharacteres)),btnSearch.addEventListener("click",handleSearch),resetGlobal.addEventListener("click",handleClickReset);